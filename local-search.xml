<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Docker国内镜像源配置</title>
    <link href="/2025/01/21/Docker%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/21/Docker%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="配置镜像"><a href="#配置镜像" class="headerlink" title="配置镜像"></a>配置镜像</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /etc/docker<br><br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="hljs-string">&#x27;EOF&#x27;</span><br>&#123;<br>    <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<br>        <span class="hljs-string">&quot;https://docker.m.daocloud.io&quot;</span>,<br>        <span class="hljs-string">&quot;https://dockerproxy.com&quot;</span>,<br>        <span class="hljs-string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>,<br>        <span class="hljs-string">&quot;https://docker.nju.edu.cn&quot;</span><br>    ]<br>&#125;<br>EOF<br><br><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br><br><span class="hljs-built_in">sudo</span> systemctl restart docker<br></code></pre></td></tr></table></figure><h3 id="另外"><a href="#另外" class="headerlink" title="另外"></a>另外</h3><p>(1)如果要删除 <code>/etc/docker/daemon.json </code>文件，可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">rm</span> -f /etc/docker/daemon.json<br></code></pre></td></tr></table></figure><p>(2)如果要手动编辑 <code>/etc/docker/daemon.json </code>文件,可以进行以下手动编辑 daemon.json 的步骤：</p><p>1.使用<code>vim</code>编辑器编辑：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vim /etc/docker/daemon.json<br></code></pre></td></tr></table></figure><p> 2.保存并退出:</p><p>输入Esc+ :wq 并按 Enter  (强制保存则+:wq!)</p><p>3.重启 Docker 服务:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart docker<br></code></pre></td></tr></table></figure><h2 id="汇总国内可用镜像"><a href="#汇总国内可用镜像" class="headerlink" title="汇总国内可用镜像"></a>汇总国内可用镜像</h2><h3 id="DaoCloud-镜像站"><a href="#DaoCloud-镜像站" class="headerlink" title="DaoCloud 镜像站"></a>DaoCloud 镜像站</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://docker.m.daocloud.io">https://docker.m.daocloud.io</a></p><p>支持：Docker Hub、GCR、K8S、GHCR、Quay、NVCR 等</p><p>对外免费：是</p><h3 id="网易云"><a href="#网易云" class="headerlink" title="网易云"></a>网易云</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://hub-mirror.c.163.com">https://hub-mirror.c.163.com</a></p><p>支持：Docker Hub</p><p>对外免费：是</p><h3 id="Docker-镜像代理"><a href="#Docker-镜像代理" class="headerlink" title="Docker 镜像代理"></a>Docker 镜像代理</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://dockerproxy.com">https://dockerproxy.com</a></p><p>支持：Docker Hub、GCR、K8S、GHCR</p><p>对外免费：是</p><h3 id="百度云"><a href="#百度云" class="headerlink" title="百度云"></a>百度云</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://mirror.baidubce.com">https://mirror.baidubce.com</a></p><p>支持：Docker Hub</p><p>对外免费：是</p><h3 id="南京大学镜像站"><a href="#南京大学镜像站" class="headerlink" title="南京大学镜像站"></a>南京大学镜像站</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://docker.nju.edu.cn">https://docker.nju.edu.cn</a></p><p>支持：Docker Hub、GCR、GHCR、Quay、NVCR 等</p><p>对外免费：是</p><h3 id="上海交大镜像站"><a href="#上海交大镜像站" class="headerlink" title="上海交大镜像站"></a>上海交大镜像站</h3><p>加速地址：<a href="https://link.zhihu.com/?target=https://docker.mirrors.sjtug.sjtu.edu.cn/">https://docker.mirrors.sjtug.sjtu.edu.cn/</a></p><p>支持：Docker Hub、GCR 等</p><p>限制：无</p>]]></content>
    
    
    <categories>
      
      <category>Docker</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Docker部署MySQL并实现远程连接</title>
    <link href="/2025/01/20/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-Docker%E9%83%A8%E7%BD%B2MySQL/"/>
    <url>/2025/01/20/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-Docker%E9%83%A8%E7%BD%B2MySQL/</url>
    
    <content type="html"><![CDATA[<p><strong>1.编写好dockerfile文件</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#指定基础镜像</span><br><span class="hljs-keyword">FROM</span> mysql:latest<br><br><span class="hljs-comment">#设置初始环境变量</span><br><span class="hljs-keyword">ENV</span> MYSQL_ROOT_PASSWORD=<span class="hljs-number">123456</span><br><br><span class="hljs-keyword">ENV</span> MYSQL_DATABASE=database<br><br><span class="hljs-comment">#用于将初始化脚本 init.sql 复制到 MySQL 容器的 /docker-entrypoint-initdb.d/ 目录中。当 #MySQL 容器启动时，它会自动执行该目录下的所有 SQL 脚本文件，从而完成数据库的初始化。</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> init.sql /docker-entrypoint-initdb.d/</span><br><br><span class="hljs-comment">#EXPOSE指令用于在Dockerfile中声明容器在运行时监听的网络端口，但它并不会自动暴露端口，也不会将容</span><br><span class="hljs-comment">#器内部的端口映射到宿主机上。其主要作用是提供一种方式，让开发者和其他人能够清楚地了解该容器需要开</span><br><span class="hljs-comment">#放哪些端口</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">3306</span> <br></code></pre></td></tr></table></figure><p><strong>2.创建容器并运行</strong></p><p>这里先切换到了我自己的MySQLDocker目录</p><p> <img src="/img/articles/18.png"> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> MySQLDocker<br></code></pre></td></tr></table></figure><p>（1）以下命令用于从当前目录下的 Dockerfile 构建一个新的 Docker 镜像，并将其命名为 <code>mysql-image</code>。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">docker build -t mysql-image .<br></code></pre></td></tr></table></figure><h6 id="详细解释："><a href="#详细解释：" class="headerlink" title="详细解释："></a><strong>详细解释</strong>：</h6><ul><li>**<code>docker build</code>**：<ul><li>这是 Docker 的一个命令，用于根据 Dockerfile 构建一个新的镜像。</li></ul></li><li>**<code>-t mysql-image</code>**：<ul><li><code>-t</code> 是 <code>--tag</code> 的简写，用于为构建的镜像指定一个名称（和可选的标签）。在这里，镜像的名称是 <code>mysql-image</code>。如果想指定一个标签（例如版本号），可以写成 <code>-t mysql-image:1.0</code>。</li></ul></li><li>**<code>.</code>**：<ul><li>表示当前目录。Docker 会在这个目录下查找 <code>Dockerfile</code>，并使用它来构建镜像。这个目录也被称为构建上下文（build context）。Docker 会将当前目录下的文件和文件夹发送到 Docker 守护进程，因此确保当前目录中包含所有需要的文件（如 <code>Dockerfile</code> 和初始化脚本）。</li></ul></li></ul><p>（2）以下命令用于从 <code>mysql-image</code> 镜像创建并启动一个新的 Docker 容器，并将其命名为 <code>mysql-container</code>。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> run --name mysql-container -p <span class="hljs-number">3306</span>:<span class="hljs-number">3306</span> -d mysql-image<br></code></pre></td></tr></table></figure><h6 id="详细解释：-1"><a href="#详细解释：-1" class="headerlink" title="详细解释："></a><strong>详细解释</strong>：</h6><ul><li>**<code>docker run</code>**：<ul><li>用于创建并启动一个新的 Docker 容器。</li></ul></li><li>**<code>--name mysql-container</code>**：<ul><li>为容器指定一个名称（<code>mysql-container</code>），便于后续操作。</li></ul></li><li>**<code>-p 3306:3306</code>**：<ul><li>将容器的 3306 端口映射到宿主机的 3306 端口。这意味着可以从宿主机或其他机器通过 <code>宿主机IP:3306</code> 访问容器中的 MySQL 服务。</li><li>格式为 <code>-p 宿主机端口:容器端口</code>。</li></ul></li><li>**<code>-d mysql-image</code>**：<ul><li><code>-d</code> 表示以 <strong>detached</strong> 模式运行容器（即在后台运行）。</li><li><code>mysql-image</code> 是刚刚构建的镜像名称，Docker 将使用它来创建容器。</li></ul></li></ul><p><strong>3.进入正在运行的 <code>mysql-container</code> 容器和进入 MySQL 的交互式命令行界面</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">docker <span class="hljs-keyword">exec</span> -it mysql-<span class="hljs-keyword">container</span> mysql -uroot -p123456<br></code></pre></td></tr></table></figure><h6 id="详细解释：-2"><a href="#详细解释：-2" class="headerlink" title="详细解释："></a><strong>详细解释</strong>：</h6><ul><li>**<code>docker exec</code>**：<ul><li>用于在正在运行的容器中执行命令。</li></ul></li><li>**<code>-it</code>**：<ul><li><code>-i</code> 表示交互式模式，允许用户与容器内的命令交互。</li><li><code>-t</code> 分配一个伪终端，使用户能够像在本地终端中一样操作。</li></ul></li><li>**<code>mysql-container</code>**：<ul><li>指定目标容器的名称（即之前创建的 <code>mysql-container</code>）。</li></ul></li><li>**<code>mysql -uroot -p123456</code>**：<ul><li>在容器内执行的命令，用于启动 MySQL 客户端。</li><li><code>-u root</code> 表示以 <code>root</code> 用户登录 MySQL。</li><li><code>-p123456</code> 表示 <code>root</code> 用户的密码是 <code>123456</code>。</li></ul></li></ul><p><strong>4.创建数据库用户并配置实现远程连接</strong>(MySQL 8.0及以上)</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> hhh@<span class="hljs-string">&#x27;%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.02</span> sec)<br><br>mysql&gt; <span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">privileges</span> <span class="hljs-keyword">on</span> *.* <span class="hljs-keyword">to</span> hhh@<span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">grant</span> <span class="hljs-keyword">option</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.01</span> sec)<br><br>mysql&gt; flush <span class="hljs-keyword">privileges</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.01</span> sec)<br><br>mysql&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>网站部署</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>运行安卓项目通用配置（java）</title>
    <link href="/2024/12/29/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E9%80%9A%E7%94%A8%E9%85%8D%E7%BD%AE/"/>
    <url>/2024/12/29/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E9%80%9A%E7%94%A8%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p> <img src="/img/articles/Android/1.jpg"> </p><p> <img src="/img/articles/Android/2.jpg"> </p><p> <img src="/img/articles/Android/3.jpg"> </p><p> <img src="/img/articles/Android/4.jpg"> </p><p> <img src="/img/articles/Android/5.jpg"> </p><p> <img src="/img/articles/Android/6.jpg"> </p>]]></content>
    
    
    <categories>
      
      <category>配置各类环境所遇问题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Linux服务器JDK安装和环境变量配置</title>
    <link href="/2024/12/07/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-JDK%E5%AE%89%E8%A3%85/"/>
    <url>/2024/12/07/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-JDK%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<p><strong>1.安装JDK</strong>：</p><ul><li><p>对于CentOS，使用如下命令：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">sudo yum install java-1.8.0-openjdk-devel<br></code></pre></td></tr></table></figure></li><li><p>这将安装OpenJDK 8，包括<code>javac</code>编译器。</p></li></ul><p><strong>2.配置环境变量</strong>：</p><ul><li><p>安装完成后，需要配置JAVA_HOME环境变量,可以通过查找java命令的路径来确定JDK的安装位置：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">sudo update-alternatives --config java<br></code></pre></td></tr></table></figure></li></ul><p>​      如下图示例：</p><p><img src="/img/articles/13.png"> </p><ul><li><p>使用文本编辑器打开<code>.bashrc</code>文件，例如使用<code>vi</code>（按i开启编辑，Esc+:wq保存+Enter退出）</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">vi ~/.bashrc<br></code></pre></td></tr></table></figure></li></ul><p>​       添加以下行到文件中：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.412.b08-1.el7_9.x86_64<br>export PATH=$PATH:$JAVA_HOME/bin<br></code></pre></td></tr></table></figure><p>​      如下图示例：</p><p><img src="/img/articles/14.png"> </p><p>​     使更改生效，运行：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">source ~/.bashrc<br></code></pre></td></tr></table></figure><p><strong>3.验证环境变量</strong>：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">echo $JAVA_HOME<br>echo $PATH<br></code></pre></td></tr></table></figure><p><strong>4.测试<code>javac</code>命令</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">javac -version<br></code></pre></td></tr></table></figure><p><strong>配置成功如下图</strong>：</p><p><img src="/img/articles/15.png"> </p><p>另外，再补充一部分以下是MySQL 8版本创建用户（赋予所有访问权限）的方法（刷新权限是flush privileges）</p><p><img src="/img/articles/16.png"> </p><p>面板也可相应创建</p>]]></content>
    
    
    <categories>
      
      <category>网站部署</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>UML课设</title>
    <link href="/2024/11/17/UML%E8%AF%BE%E8%AE%BE/"/>
    <url>/2024/11/17/UML%E8%AF%BE%E8%AE%BE/</url>
    
    <content type="html"><![CDATA[<p>课题：</p><p>利用面向对象思维与Python语言，设计一个仿真系统<br>1.设计思路汇报<br>2.编程实现</p><p>系统名称：投币式饮料自助售卖机系统</p><p><strong>Python代码实现</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> tkinter <span class="hljs-keyword">as</span> tk<br><span class="hljs-keyword">from</span> tkinter <span class="hljs-keyword">import</span> messagebox, simpledialog<br><br><span class="hljs-comment"># 用户基类，包含共有属性和方法</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:<br>    total_time_spent = <span class="hljs-number">0</span>  <span class="hljs-comment"># 记录所有用户的总耗时时间</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-comment"># 初始化用户的名字</span><br>        <span class="hljs-variable language_">self</span>.name = name<br><br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_time_spent</span>(<span class="hljs-params">cls, time_spent</span>):<br>        <span class="hljs-comment"># 类方法，用于累加操作的耗时</span><br>        cls.total_time_spent += time_spent  <span class="hljs-comment"># 增加耗时时间</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;操作耗时：<span class="hljs-subst">&#123;time_spent&#125;</span>秒，累计耗时：<span class="hljs-subst">&#123;cls.total_time_spent&#125;</span>秒。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">browse_drinks</span>(<span class="hljs-params">self, vending_machine, time_spent=<span class="hljs-number">20</span></span>):<br>        <span class="hljs-comment"># 用户浏览饮料的方法</span><br>        vending_machine.browse_drinks()  <span class="hljs-comment"># 调用售卖机的浏览饮料方法</span><br>        User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加浏览饮料的耗时</span><br><br><span class="hljs-comment"># 顾客类，继承自用户类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Customer</span>(<span class="hljs-title class_ inherited__">User</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, customer_id</span>):<br>        <span class="hljs-built_in">super</span>().__init__(name)  <span class="hljs-comment"># 调用父类的构造方法初始化名字</span><br>        <span class="hljs-variable language_">self</span>.customer_id = customer_id  <span class="hljs-comment"># 初始化顾客ID</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">browse_drinks</span>(<span class="hljs-params">self, vending_machine</span>):<br>        <span class="hljs-built_in">super</span>().browse_drinks(vending_machine)  <span class="hljs-comment"># 调用父类的浏览饮料方法</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">buy_drink</span>(<span class="hljs-params">self, drink_name, coin_value, vending_machine, time_spent=<span class="hljs-number">5</span></span>):<br>        <span class="hljs-comment">#顾客购买饮料的方法</span><br>        <span class="hljs-keyword">if</span> drink_name <span class="hljs-keyword">in</span> vending_machine.drinks:  <span class="hljs-comment"># 检查饮料是否存在</span><br>            drink = vending_machine.drinks[drink_name]<br>            <span class="hljs-keyword">if</span> drink.quantity &gt; <span class="hljs-number">0</span>:  <span class="hljs-comment"># 检查库存</span><br>                <span class="hljs-keyword">if</span> coin_value &gt;= drink.price:  <span class="hljs-comment"># 检查支付是否足够</span><br>                    change = coin_value - drink.price<br>                    <span class="hljs-keyword">if</span> change == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> vending_machine.calculate_change(change):  <span class="hljs-comment"># 检查是否可以找零</span><br>                        drink.quantity -= <span class="hljs-number">1</span>  <span class="hljs-comment"># 减少库存</span><br>                        vending_machine.save_drinks()  <span class="hljs-comment"># 保存饮料信息</span><br>                        vending_machine.save_transaction(coin_value)  <span class="hljs-comment"># 保存交易信息</span><br>                        User.add_time_spent(time_spent)  <span class="hljs-comment"># 记录耗时</span><br>                        <span class="hljs-keyword">if</span> change &gt; <span class="hljs-number">0</span>:<br>                            vending_machine.distribute_change(change)  <span class="hljs-comment"># 发放找零</span><br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, change  <span class="hljs-comment"># 返回成功和找零金额</span><br>                        <span class="hljs-keyword">else</span>:<br>                            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>, <span class="hljs-number">0</span>  <span class="hljs-comment"># 返回成功和0找零</span><br>                    <span class="hljs-keyword">else</span>:<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无法找零，请尝试其他面额的硬币。&quot;</span>)<br>                        User.add_time_spent(time_spent)<br>                        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;资金不足，请增加硬币数量。&quot;</span>)<br>                    User.add_time_spent(time_spent)<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;饮料缺货。&quot;</span>)<br>                User.add_time_spent(time_spent)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;未找到饮料。&quot;</span>)<br>            User.add_time_spent(time_spent)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 管理员类，继承自用户类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Admin</span>(<span class="hljs-title class_ inherited__">User</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, admin_id, password</span>):<br>        <span class="hljs-built_in">super</span>().__init__(name)  <span class="hljs-comment"># 调用父类构造方法初始化名字</span><br>        <span class="hljs-variable language_">self</span>.admin_id = admin_id  <span class="hljs-comment"># 初始化管理员ID</span><br>        <span class="hljs-variable language_">self</span>.password = password  <span class="hljs-comment"># 初始化管理员密码</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">self, admin_id, password, time_spent=<span class="hljs-number">3</span></span>):<br>        <span class="hljs-comment"># 管理员登录</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.admin_id == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-variable language_">self</span>.password == <span class="hljs-string">&quot;admin&quot;</span>:  <span class="hljs-comment"># 验证管理员凭证</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;管理员登录成功。&quot;</span>)<br>            User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加登录时间</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;管理员凭证无效。&quot;</span>)<br>            User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">replenish_drink</span>(<span class="hljs-params">self, drink_name, quantity, price, vending_machine, time_spent=<span class="hljs-number">3</span></span>):<br>        <span class="hljs-comment"># 管理员补充饮料</span><br>        vending_machine.add_drink(Drink(drink_name, quantity, price))  <span class="hljs-comment"># 将饮料添加到售卖机</span><br>        vending_machine.save_drinks()  <span class="hljs-comment"># 保存饮料信息</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;补充饮料库存成功。&quot;</span>)<br>        User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">replenish_change</span>(<span class="hljs-params">self, coin_denomination, quantity, vending_machine, time_spent=<span class="hljs-number">2</span></span>):<br>        <span class="hljs-comment"># 管理员补充找零硬币</span><br>        <span class="hljs-keyword">if</span> coin_denomination <span class="hljs-keyword">in</span> vending_machine.coins:<br>            vending_machine.coins[coin_denomination].set_total(<br>                vending_machine.coins[coin_denomination].total + quantity)  <span class="hljs-comment"># 更新硬币数量</span><br>        <span class="hljs-keyword">else</span>:<br>            vending_machine.add_coin(Coin(coin_denomination))  <span class="hljs-comment"># 新增硬币面额</span><br>            vending_machine.coins[coin_denomination].set_total(quantity)  <span class="hljs-comment"># 设置数量</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;补充找零硬币成功。&quot;</span>)<br>        User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">collect_coins</span>(<span class="hljs-params">self, vending_machine, time_spent=<span class="hljs-number">10</span></span>):<br>        <span class="hljs-comment"># 提取硬币</span><br>        collected_coins = vending_machine.collect_income_from_file()  <span class="hljs-comment"># 从文件收取硬币</span><br>        vending_machine.delete_income_file()  <span class="hljs-comment"># 删除收入文件</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;已提取<span class="hljs-subst">&#123;collected_coins&#125;</span>元硬币。&quot;</span>)<br>        User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br>        <span class="hljs-keyword">return</span> collected_coins<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_drink_price</span>(<span class="hljs-params">self, drink_name, price, vending_machine, time_spent=<span class="hljs-number">2</span></span>):<br>        <span class="hljs-comment"># 设定饮料价格</span><br>        <span class="hljs-keyword">if</span> drink_name <span class="hljs-keyword">in</span> vending_machine.drinks:<br>            vending_machine.drinks[drink_name].set_price(price)  <span class="hljs-comment"># 设置饮料新价格</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;drink_name&#125;</span>的价格已设定为<span class="hljs-subst">&#123;price&#125;</span>&quot;</span>)<br>            User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  <span class="hljs-comment"># 返回True表示成功设置价格</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;未找到饮料，无法设置价格。&quot;</span>)<br>            User.add_time_spent(time_spent)  <span class="hljs-comment"># 累加时间</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>  <span class="hljs-comment"># 返回False表示未找到饮料</span><br><br><span class="hljs-comment"># 饮料类，描述饮料的属性和行为</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Drink</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, quantity, price</span>):<br>        <span class="hljs-variable language_">self</span>.name = name  <span class="hljs-comment"># 饮料名称</span><br>        <span class="hljs-variable language_">self</span>.quantity = quantity  <span class="hljs-comment"># 饮料数量</span><br>        <span class="hljs-variable language_">self</span>.price = price  <span class="hljs-comment"># 饮料价格</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_price</span>(<span class="hljs-params">self, price</span>):<br>        <span class="hljs-comment"># 设定饮料价格</span><br>        <span class="hljs-variable language_">self</span>.price = price  <span class="hljs-comment"># 更新价格</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_name</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-comment"># 设定饮料名称</span><br>        <span class="hljs-variable language_">self</span>.name = name<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_quantity</span>(<span class="hljs-params">self, quantity</span>):<br>        <span class="hljs-comment"># 设定饮料数量</span><br>        <span class="hljs-variable language_">self</span>.quantity = quantity<br><br><span class="hljs-comment"># 硬币类，描述硬币的属性和行为</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Coin</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, denomination</span>):<br>        <span class="hljs-variable language_">self</span>.denomination = denomination  <span class="hljs-comment"># 硬币面额</span><br>        <span class="hljs-variable language_">self</span>.total = <span class="hljs-number">0</span>  <span class="hljs-comment"># 硬币数量</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_denomination</span>(<span class="hljs-params">self, denomination</span>):<br>        <span class="hljs-variable language_">self</span>.denomination = denomination  <span class="hljs-comment"># 设定硬币面额</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_total</span>(<span class="hljs-params">self, total</span>):<br>        <span class="hljs-variable language_">self</span>.total = total  <span class="hljs-comment"># 设定硬币数量</span><br><br><span class="hljs-comment"># 售卖机类，管理饮料、硬币以及收入</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">VendingMachine</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.drinks = &#123;&#125;  <span class="hljs-comment"># 饮料库存</span><br>        <span class="hljs-variable language_">self</span>.coins = &#123;&#125;  <span class="hljs-comment"># 找零硬币数量</span><br>        <span class="hljs-variable language_">self</span>.total_income = <span class="hljs-number">0</span>  <span class="hljs-comment"># 总收入</span><br>        <span class="hljs-variable language_">self</span>.load_drinks()  <span class="hljs-comment"># 加载饮料信息，读取文件中的饮料信息</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_drink</span>(<span class="hljs-params">self, drink</span>):<br>        <span class="hljs-comment"># 添加饮料到库存</span><br>        <span class="hljs-variable language_">self</span>.drinks[drink.name] = drink<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_coin</span>(<span class="hljs-params">self, coin</span>):<br>        <span class="hljs-comment"># 添加找零硬币</span><br>        <span class="hljs-keyword">if</span> coin.denomination <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.coins:<br>            <span class="hljs-variable language_">self</span>.coins[coin.denomination].total += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.coins[coin.denomination] = coin<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">browse_drinks</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 显示售卖机饮料中的饮料列表</span><br>        drink_list = <span class="hljs-string">&quot;\n&quot;</span>.join([<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span>: 库存<span class="hljs-subst">&#123;drink.quantity&#125;</span>，价格：<span class="hljs-subst">&#123;drink.price&#125;</span>&quot;</span><br>                                <span class="hljs-keyword">for</span> name, drink <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.drinks.items()])<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> drink_list:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;目前售卖机没有饮料。&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;目前可购买的饮料列表：&quot;</span>)<br>            <span class="hljs-built_in">print</span>(drink_list)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_drinks</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 将饮料信息保存到文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;drinks.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            <span class="hljs-keyword">for</span> name, drink <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.drinks.items():<br>                f.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span>,<span class="hljs-subst">&#123;drink.quantity&#125;</span>,<span class="hljs-subst">&#123;drink.price&#125;</span>\n&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_drinks</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 从文件加载饮料信息</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;drinks.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>                    name, quantity, price = line.strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>                    <span class="hljs-variable language_">self</span>.add_drink(Drink(name, <span class="hljs-built_in">int</span>(quantity), <span class="hljs-built_in">float</span>(price)))<br>        <span class="hljs-keyword">except</span> FileNotFoundError:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;目前售卖机没有饮料。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_change</span>(<span class="hljs-params">self, change</span>):<br>        <span class="hljs-comment"># 计算找零</span><br>        sorted_denominations = <span class="hljs-built_in">sorted</span>(<span class="hljs-variable language_">self</span>.coins.keys(), reverse=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># 按硬币面额降序排列</span><br>        <span class="hljs-keyword">for</span> denomination <span class="hljs-keyword">in</span> sorted_denominations:<br>            coins_to_give = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">int</span>(change // denomination), <span class="hljs-variable language_">self</span>.coins[denomination].total)<br>            <span class="hljs-keyword">if</span> coins_to_give &gt; <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.coins[denomination].total -= coins_to_give<br>                change -= coins_to_give * denomination<br>            <span class="hljs-keyword">if</span> change == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">distribute_change</span>(<span class="hljs-params">self, change</span>):<br>        <span class="hljs-comment"># 分发找零硬币</span><br>        sorted_denominations = <span class="hljs-built_in">sorted</span>(<span class="hljs-variable language_">self</span>.coins.keys(), reverse=<span class="hljs-literal">True</span>)<br>        <span class="hljs-keyword">for</span> denomination <span class="hljs-keyword">in</span> sorted_denominations:<br>            coins_to_give = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">int</span>(change // denomination), <span class="hljs-variable language_">self</span>.coins[denomination].total)<br>            <span class="hljs-keyword">if</span> coins_to_give &gt; <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.coins[denomination].total -= coins_to_give<br>                change -= coins_to_give * denomination<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;发放面额 <span class="hljs-subst">&#123;denomination&#125;</span> 元的硬币 <span class="hljs-subst">&#123;coins_to_give&#125;</span> 枚&quot;</span>)<br>        <span class="hljs-keyword">return</span> change == <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_transaction</span>(<span class="hljs-params">self, coin_value</span>):<br>        <span class="hljs-comment"># 保存交易记录到文件</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;income.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;coin_value&#125;</span>\n&quot;</span>)<br>            <span class="hljs-variable language_">self</span>.total_income += coin_value<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;写入文件时发生错误：<span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">collect_income_from_file</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 从文件计算收入总和</span><br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;income.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                income = <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">float</span>(line.strip()) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f)<br>            <span class="hljs-keyword">return</span> income<br>        <span class="hljs-keyword">except</span> FileNotFoundError:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;未查询到收入。&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_income_file</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 删除收入文件</span><br>        <span class="hljs-keyword">try</span>:<br>            os.remove(<span class="hljs-string">&#x27;income.txt&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;当前将用户投入的所有硬币全部提取出来。&quot;</span>)<br>        <span class="hljs-keyword">except</span> FileNotFoundError:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;没有硬币可提取。&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;删除文件时发生错误：<span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 可视化界面部分</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">GUI</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, master, vending_machine, customer, admin</span>):<br>        <span class="hljs-comment"># 初始化图形界面的构造方法</span><br>        <span class="hljs-variable language_">self</span>.master = master<br>        <span class="hljs-variable language_">self</span>.master.title(<span class="hljs-string">&quot;投币式饮料自助售卖机系统&quot;</span>)<br>        <span class="hljs-variable language_">self</span>.vending_machine = vending_machine<br>        <span class="hljs-variable language_">self</span>.customer = customer<br>        <span class="hljs-variable language_">self</span>.admin = admin<br><br>        <span class="hljs-comment"># 创建窗口顶部的标题标签</span><br>        title_label = tk.Label(master, text=<span class="hljs-string">&quot;投币式饮料自助售卖机系统&quot;</span>, font=(<span class="hljs-string">&quot;Arial&quot;</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&quot;bold&quot;</span>))<br>        title_label.pack(pady=<span class="hljs-number">10</span>)  <span class="hljs-comment"># 放置标题标签，并在垂直方向上添加外边距</span><br><br>        <span class="hljs-comment"># 创建操作按钮</span><br>        <span class="hljs-variable language_">self</span>.browse_button = tk.Button(master, text=<span class="hljs-string">&quot;浏览饮料&quot;</span>, command=<span class="hljs-variable language_">self</span>.browse_drinks)<br>        <span class="hljs-variable language_">self</span>.browse_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        <span class="hljs-variable language_">self</span>.buy_button = tk.Button(master, text=<span class="hljs-string">&quot;购买饮料&quot;</span>, command=<span class="hljs-variable language_">self</span>.buy_drink)<br>        <span class="hljs-variable language_">self</span>.buy_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        <span class="hljs-variable language_">self</span>.admin_button = tk.Button(master, text=<span class="hljs-string">&quot;管理员登录&quot;</span>, command=<span class="hljs-variable language_">self</span>.admin_login)<br>        <span class="hljs-variable language_">self</span>.admin_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        <span class="hljs-variable language_">self</span>.quit_button = tk.Button(master, text=<span class="hljs-string">&quot;退出&quot;</span>, command=master.quit)<br>        <span class="hljs-variable language_">self</span>.quit_button.pack(pady=<span class="hljs-number">10</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">browse_drinks</span>(<span class="hljs-params">self</span>):<br>        start_time = time.time()  <span class="hljs-comment"># 记录开始时间</span><br>        drink_list = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> name, drink <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.vending_machine.drinks.items():<br>            drink_list += <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span>: 库存<span class="hljs-subst">&#123;drink.quantity&#125;</span>，价格：<span class="hljs-subst">&#123;drink.price&#125;</span>\n&quot;</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> drink_list:<br>            drink_list = <span class="hljs-string">&quot;目前售卖机没有饮料。&quot;</span><br><br>        messagebox.showinfo(<span class="hljs-string">&quot;浏览饮料&quot;</span>, drink_list)<br>        end_time = time.time()  <span class="hljs-comment"># 记录结束时间</span><br>        elapsed_time = end_time - start_time<br>        elapsed_time = <span class="hljs-built_in">round</span>(elapsed_time)<br>        User.add_time_spent(elapsed_time)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">buy_drink</span>(<span class="hljs-params">self</span>):<br>        drink_name = simpledialog.askstring(<span class="hljs-string">&quot;购买饮料&quot;</span>, <span class="hljs-string">&quot;请输入饮料名称：&quot;</span>)<br>        coin_value = simpledialog.askfloat(<span class="hljs-string">&quot;购买饮料&quot;</span>, <span class="hljs-string">&quot;请输入投入硬币的金额：&quot;</span>)<br><br>        success, change = <span class="hljs-variable language_">self</span>.customer.buy_drink(drink_name, coin_value, <span class="hljs-variable language_">self</span>.vending_machine)<br>        <span class="hljs-keyword">if</span> success:<br>            <span class="hljs-keyword">if</span> change &gt; <span class="hljs-number">0</span>:<br>                messagebox.showinfo(<span class="hljs-string">&quot;购买成功&quot;</span>, <span class="hljs-string">f&quot;购买成功！发放找零：<span class="hljs-subst">&#123;change&#125;</span>元。&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                messagebox.showinfo(<span class="hljs-string">&quot;购买成功&quot;</span>, <span class="hljs-string">&quot;购买成功！不需要找零。&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showerror(<span class="hljs-string">&quot;购买失败&quot;</span>, <span class="hljs-string">&quot;购买失败，请检查饮料是否有货或硬币金额是否足够。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_login</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 管理员登录处理</span><br>        login_window = tk.Toplevel(<span class="hljs-variable language_">self</span>.master)<br>        login_window.title(<span class="hljs-string">&quot;管理员登录&quot;</span>)<br><br>        tk.Label(login_window, text=<span class="hljs-string">&quot;管理员ID:&quot;</span>).pack(pady=<span class="hljs-number">5</span>)<br>        admin_id = tk.Entry(login_window)<br>        admin_id.pack(pady=<span class="hljs-number">5</span>)<br><br>        tk.Label(login_window, text=<span class="hljs-string">&quot;管理员密码:&quot;</span>).pack(pady=<span class="hljs-number">5</span>)<br>        password = tk.Entry(login_window, show=<span class="hljs-string">&quot;*&quot;</span>)<br>        password.pack(pady=<span class="hljs-number">5</span>)<br><br>        login_button = tk.Button(login_window, text=<span class="hljs-string">&quot;登录&quot;</span>,<br>                                 command=<span class="hljs-keyword">lambda</span>: <span class="hljs-variable language_">self</span>.admin_actions(admin_id.get(), password.get()))<br>        login_button.pack(pady=<span class="hljs-number">10</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_actions</span>(<span class="hljs-params">self, admin_id, password</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.admin.login(admin_id, password):<br>            <span class="hljs-variable language_">self</span>.admin_menu()<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showerror(<span class="hljs-string">&quot;登录失败&quot;</span>, <span class="hljs-string">&quot;管理员凭证无效，请重试。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_menu</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 管理员操作菜单</span><br>        menu_window = tk.Toplevel(<span class="hljs-variable language_">self</span>.master)<br>        menu_window.title(<span class="hljs-string">&quot;管理员操作&quot;</span>)<br><br>        replenish_drinks_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;补充饮料&quot;</span>, command=<span class="hljs-variable language_">self</span>.replenish_drinks)<br>        replenish_drinks_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        batch_import_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;批量补充饮料&quot;</span>, command=<span class="hljs-variable language_">self</span>.batch_import_drinks)<br>        batch_import_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        replenish_change_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;补充找零硬币&quot;</span>, command=<span class="hljs-variable language_">self</span>.replenish_change)<br>        replenish_change_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        collect_coins_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;提取硬币&quot;</span>, command=<span class="hljs-variable language_">self</span>.collect_coins)<br>        collect_coins_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        set_price_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;设定饮料价格&quot;</span>, command=<span class="hljs-variable language_">self</span>.set_drink_price)<br>        set_price_button.pack(pady=<span class="hljs-number">10</span>)<br><br>        logout_button = tk.Button(menu_window, text=<span class="hljs-string">&quot;注销&quot;</span>, command=menu_window.destroy)<br>        logout_button.pack(pady=<span class="hljs-number">10</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">replenish_drinks</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 补充饮料的功能</span><br>        drink_name = simpledialog.askstring(<span class="hljs-string">&quot;补充饮料&quot;</span>, <span class="hljs-string">&quot;请输入饮料名称：&quot;</span>)<br>        <span class="hljs-keyword">if</span> drink_name:  <span class="hljs-comment"># 检查用户是否输入了饮料名称</span><br>            quantity = simpledialog.askinteger(<span class="hljs-string">&quot;补充饮料&quot;</span>, <span class="hljs-string">&quot;请输入补充数量：&quot;</span>)<br>            <span class="hljs-keyword">if</span> quantity <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 检查用户是否输入了数量</span><br>                price = simpledialog.askfloat(<span class="hljs-string">&quot;补充饮料&quot;</span>, <span class="hljs-string">&quot;请输入饮料价格：&quot;</span>)<br>                <span class="hljs-keyword">if</span> price <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 检查用户是否输入了价格</span><br>                    <span class="hljs-variable language_">self</span>.admin.replenish_drink(drink_name, quantity, price, <span class="hljs-variable language_">self</span>.vending_machine)<br>                    messagebox.showinfo(<span class="hljs-string">&quot;补充成功&quot;</span>, <span class="hljs-string">&quot;饮料库存补充成功！&quot;</span>)<br>                    <span class="hljs-variable language_">self</span>.vending_machine.save_drinks()  <span class="hljs-comment"># 保存饮料信息</span><br>                <span class="hljs-keyword">else</span>:<br>                    messagebox.showwarning(<span class="hljs-string">&quot;补充失败&quot;</span>, <span class="hljs-string">&quot;请输入有效的饮料价格。&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                messagebox.showwarning(<span class="hljs-string">&quot;补充失败&quot;</span>, <span class="hljs-string">&quot;请输入有效的补充数量。&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showwarning(<span class="hljs-string">&quot;补充失败&quot;</span>, <span class="hljs-string">&quot;请输入饮料名称。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_import_drinks</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 批量补充饮料的功能</span><br>        start_time = time.time()  <span class="hljs-comment"># 记录开始时间</span><br>        import_window = tk.Toplevel(<span class="hljs-variable language_">self</span>.master)<br>        import_window.title(<span class="hljs-string">&quot;批量补充饮料&quot;</span>)<br><br>        tk.Label(import_window, text=<span class="hljs-string">&quot;请输入饮料数据（格式：名称,数量,价格）：&quot;</span>).pack(pady=<span class="hljs-number">5</span>)<br>        text_area = tk.Text(import_window, height=<span class="hljs-number">10</span>, width=<span class="hljs-number">50</span>)<br>        text_area.pack(pady=<span class="hljs-number">5</span>)<br>        import_button = tk.Button(import_window, text=<span class="hljs-string">&quot;补充&quot;</span>, command=<span class="hljs-keyword">lambda</span>: <span class="hljs-variable language_">self</span>.import_drinks(text_area.get(<span class="hljs-string">&quot;1.0&quot;</span>, tk.END), start_time))<br>        import_button.pack(pady=<span class="hljs-number">10</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">import_drinks</span>(<span class="hljs-params">self, data, start_time</span>):<br>        <span class="hljs-comment"># 处理批量补充饮料数据</span><br>        lines = data.strip().split(<span class="hljs-string">&quot;\n&quot;</span>)<br>        success_count = <span class="hljs-number">0</span><br>        fail_count = <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>            <span class="hljs-keyword">try</span>:<br>                name, quantity, price = line.split(<span class="hljs-string">&quot;,&quot;</span>)<br>                quantity = <span class="hljs-built_in">int</span>(quantity)<br>                price = <span class="hljs-built_in">float</span>(price)<br>                <span class="hljs-variable language_">self</span>.admin.replenish_drink(name, quantity, price, <span class="hljs-variable language_">self</span>.vending_machine)<br>                success_count += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">except</span> ValueError:<br>                fail_count += <span class="hljs-number">1</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;格式错误或数据转换失败：<span class="hljs-subst">&#123;line&#125;</span>&quot;</span>)<br><br>        end_time = time.time()  <span class="hljs-comment"># 记录结束时间</span><br>        elapsed_time = end_time - start_time<br>        elapsed_time = <span class="hljs-built_in">round</span>(elapsed_time)<br>        User.add_time_spent(elapsed_time)<br><br>        <span class="hljs-keyword">if</span> success_count &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-variable language_">self</span>.vending_machine.save_drinks()<br>            messagebox.showinfo(<span class="hljs-string">&quot;批量补充成功&quot;</span>, <span class="hljs-string">f&quot;成功导入<span class="hljs-subst">&#123;success_count&#125;</span>条数据。&quot;</span>)<br>        <span class="hljs-keyword">if</span> fail_count &gt; <span class="hljs-number">0</span>:<br>            messagebox.showwarning(<span class="hljs-string">&quot;批量补充失败&quot;</span>, <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;fail_count&#125;</span>条数据格式错误或转换失败。请检查输入格式。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">replenish_change</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 补充找零硬币的功能</span><br>        coin_denomination = simpledialog.askinteger(<span class="hljs-string">&quot;补充硬币&quot;</span>, <span class="hljs-string">&quot;请输入硬币面额：&quot;</span>)<br>        <span class="hljs-keyword">if</span> coin_denomination <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 检查用户是否输入了硬币面额</span><br>            quantity = simpledialog.askinteger(<span class="hljs-string">&quot;补充硬币&quot;</span>, <span class="hljs-string">&quot;请输入补充数量：&quot;</span>)<br>            <span class="hljs-keyword">if</span> quantity <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 检查用户是否输入了数量</span><br>                <span class="hljs-variable language_">self</span>.admin.replenish_change(coin_denomination, quantity, <span class="hljs-variable language_">self</span>.vending_machine)<br>                messagebox.showinfo(<span class="hljs-string">&quot;补充成功&quot;</span>, <span class="hljs-string">&quot;找零硬币补充成功！&quot;</span>)<br>                <span class="hljs-variable language_">self</span>.vending_machine.save_drinks()  <span class="hljs-comment"># 保存找零硬币信息</span><br>            <span class="hljs-keyword">else</span>:<br>                messagebox.showwarning(<span class="hljs-string">&quot;取消操作&quot;</span>, <span class="hljs-string">&quot;未输入数量，操作已取消。&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showwarning(<span class="hljs-string">&quot;取消操作&quot;</span>, <span class="hljs-string">&quot;未输入硬币面额，操作已取消。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">collect_coins</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 提取硬币的功能</span><br>        collected_coins = <span class="hljs-variable language_">self</span>.admin.collect_coins(<span class="hljs-variable language_">self</span>.vending_machine)<br>        <span class="hljs-keyword">if</span> collected_coins <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            message = <span class="hljs-string">f&quot;硬币提取成功！共提取<span class="hljs-subst">&#123;collected_coins&#125;</span>元硬币。&quot;</span><br>            messagebox.showinfo(<span class="hljs-string">&quot;提取成功&quot;</span>, message)<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showinfo(<span class="hljs-string">&quot;提取成功&quot;</span>, <span class="hljs-string">&quot;没有硬币可提取。&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_drink_price</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 设置饮料价格的功能</span><br>        drink_name = simpledialog.askstring(<span class="hljs-string">&quot;设定价格&quot;</span>, <span class="hljs-string">&quot;请输入饮料名称：&quot;</span>)<br>        <span class="hljs-keyword">if</span> drink_name:  <span class="hljs-comment"># 检查用户是否输入了饮料名称</span><br>            price = simpledialog.askfloat(<span class="hljs-string">&quot;设定价格&quot;</span>, <span class="hljs-string">&quot;请输入新价格：&quot;</span>)<br>            <span class="hljs-keyword">if</span> price <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 检查用户是否输入了价格</span><br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.admin.set_drink_price(drink_name, price, <span class="hljs-variable language_">self</span>.vending_machine):<br>                    messagebox.showwarning(<span class="hljs-string">&quot;设置失败&quot;</span>, <span class="hljs-string">&quot;未找到饮料，无法设置价格。&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                messagebox.showwarning(<span class="hljs-string">&quot;设置失败&quot;</span>, <span class="hljs-string">&quot;请输入有效的价格。&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            messagebox.showwarning(<span class="hljs-string">&quot;设置失败&quot;</span>, <span class="hljs-string">&quot;请输入饮料名称。&quot;</span>)<br><span class="hljs-comment"># 主程序，创建应用并启动</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_vending_machine_gui</span>():<br>    <span class="hljs-comment"># 初始化各个对象</span><br>    vending_machine = VendingMachine()<br>    customer = Customer(<span class="hljs-string">&quot;用户&quot;</span>, <span class="hljs-string">&quot;user&quot;</span>)<br>    admin = Admin(<span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;admin&quot;</span>, <span class="hljs-string">&quot;admin&quot;</span>)<br><br>    root = tk.Tk()<br>    root.geometry(<span class="hljs-string">&quot;600x400&quot;</span>)  <span class="hljs-comment"># 设置窗口大小</span><br>    app = GUI(root, vending_machine, customer, admin)<br><br>    <span class="hljs-comment"># 初始化饮料和找零硬币</span><br>    admin.replenish_drink(<span class="hljs-string">&quot;可乐&quot;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3.0</span>, vending_machine, time_spent=<span class="hljs-number">3</span>)<br>    admin.replenish_drink(<span class="hljs-string">&quot;雪碧&quot;</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3.0</span>, vending_machine, time_spent=<span class="hljs-number">3</span>)<br>    admin.replenish_drink(<span class="hljs-string">&quot;矿泉水&quot;</span>, <span class="hljs-number">20</span>, <span class="hljs-number">2.0</span>, vending_machine, time_spent=<span class="hljs-number">3</span>)<br>    admin.replenish_change(<span class="hljs-number">1.0</span>, <span class="hljs-number">1000</span>, vending_machine, time_spent=<span class="hljs-number">2</span>)<br><br>    root.mainloop()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    run_vending_machine_gui()<br>       <span class="hljs-comment"># 投币式饮料自助售卖机系统程序说明：</span><br><span class="hljs-comment"># 1.程序运行之后会有一个可视化的界面弹窗用来进行交互</span><br><span class="hljs-comment"># 2.系统是基于时间的，每一个操作都设置了具体时间消耗，会在执行之后在控制台打印出来</span><br><span class="hljs-comment"># 3.程序开始运行后，会先进行补充饮料和找零硬币的初始化</span><br><span class="hljs-comment"># 4.管理员登录操作的账号是admin，密码是admin</span><br><span class="hljs-comment"># 5.顾客投入的硬币数据通过写入新建的文本文件(.txt)来存储</span><br><span class="hljs-comment"># 6.管理员补充的饮料相关数据通过写入新建的文本文件(.txt)来存储</span><br><span class="hljs-comment"># 7.管理员提取硬币操作提取的是顾客投入的硬币，不提取找零硬币</span><br><span class="hljs-comment"># 8.管理员能够对饮料数据进行批量补充</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>面向对象分析与设计</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>实战后端接入物联网API</title>
    <link href="/2024/11/16/%E7%89%A9%E8%81%94%E7%BD%91API%E6%8E%A5%E5%85%A5%E5%90%8E%E7%AB%AF/"/>
    <url>/2024/11/16/%E7%89%A9%E8%81%94%E7%BD%91API%E6%8E%A5%E5%85%A5%E5%90%8E%E7%AB%AF/</url>
    
    <content type="html"><![CDATA[<p>团队项目有一个业务要获取阿里云物联网平台上面的传感器数据，代码使用java，采用springboot框架，阿里云物联网平台上一个产品下的一个设备只能连接真实设备或者代码服务端，于是我采用数据流转的方式将数据流转到一个设备中，服务端订阅该设备的<strong>Topic</strong>。</p><p><strong>这里先讲讲我在接入真实设备并将数据信息上传到阿里云的云端平台设备，但是后端会被挤掉线的问题的解决方式:</strong></p><p><em>以下是相关记录</em></p><ol><li><p>解决了后端连接阿里云物联网平台掉线问题，能够收到真实设备所发的信息</p><p><img src="/img/articles/9.png"></p></li></ol><p>解决方式：</p><p>a.在阿里云物联网平台使用同一个产品密钥又再建立了一台新设备，将真实设备传到的阿里云端（之前建好设备）的消息再进行一次转发到新设备，使后端连接这台新备进行消息接收并且不会掉线。</p><p>  <img src="/img/articles/10.png"> </p><p>b.后端接收消息流程如下（采用MQTT协议,只允许一对一的连接，若有多个连接，会把先连接的下线掉）：</p><p>  <img src="/img/articles/11.png"> </p><h2 id="阿里云创建"><a href="#阿里云创建" class="headerlink" title="阿里云创建"></a>阿里云创建</h2><p>首先创建一个产品，用于测试使用，直接选择一个标准品类，品类有温度和湿度属性（实际使用需要按需求自定义产品），节点类型为了方便选的直连设备。</p><p>产品创建完成之后点击<strong>查看</strong>，点击<strong>功能定义</strong>模块，编辑草稿，添加刚才选择的标准产品的两个标准功能，也可以添加自定义功能看自己选择，这边只使用温度和湿度。</p><p>发布完成之后进入Topic 类列表的自定义Topic 部分</p><p>定义一个Topic类，便于后面通过该Topic流转到服务器端，操作权限为发布和订阅，命名为tento(按照自己需求命名)，点击确认就定义完成了。</p><p>之后为这个产品添加两个设备（一个真实设备，一个服务器设备（一个用来收真实设备的信息，一个用来将真实设备的信息转过来节接收）），实际使用可以创建多个真实设备，数据流转到一个服务器设备中就可以了，为了方便这边只创建两个设备测试。直接添加，DeviceName让他随机生成。</p><p>创建一个解析器（在云产品流转那里）</p><p>点击查看这个数据源，添加Topic，因为我要获取真实设备的数据，所以选择物模型数据上报的Topic，设备DeviceName选择刚才创建的真实设备，最后选择post。这样数据源就完成了</p><p>然后进入数据目的，点击关联数据目的</p><p>和刚才操作类似点击关联数据目的—-&gt;创建数据目的，产品选择我们一开始创建的产品，操作为发送到另一个Topic。</p><p>最后是解析器脚本，会有一个草稿，脚本中的writeIotTopic(1004），<strong>1004是自动生成的，自己的代码不要改这个</strong></p><p>改为</p><p>只更改了&#x2F;k1a8gKQzYMD&#x2F;ejP0IrtXk49UIMz7Wsn1&#x2F;user&#x2F;tento是刚才咱们自定义的Topic，k1a8gKQzYMD为产品的ProductKey，ejP0IrtXk49UIMz7Wsn1为服务端设备的DeviceName，点击发布就完成了这个解析器，解析器一定要点击启动才会生效。</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>开两个设备模拟器</p><p>真实设备端</p><p>服务器端</p><p>服务器端订阅刚才自定义的Topic</p><p>点击订阅之后，右边日志会显示订阅的Topic <strong>(订阅这一步不能省)</strong></p><p>再回到真实设备的模拟器（<strong>服务器模拟器不要关</strong>，<strong>开两个网页</strong>），输入温度湿度数据之后，点击提交，模拟真实设备提交数据。</p><p>真实设备提交数据之后，刚才服务器设备的模拟器订阅了这个消息，就会收到消息。</p><p>消息中包括刚才真实设备上传的温度湿度，还包括真实设备的deviceName，这样如果多个真实设备上传数据，全部流转到服务器端，服务器端就是知道真实设备是哪一个，上传的数据是多少。</p>]]></content>
    
    
    <categories>
      
      <category>物联网API接入</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>后端接入讯飞星火API</title>
    <link href="/2024/11/16/AI%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A51/"/>
    <url>/2024/11/16/AI%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A51/</url>
    
    <content type="html"><![CDATA[<p>如何引入？先看官方文档</p><p><a href="https://www.xfyun.cn/doc/spark/Web.html#_2-function-call%E8%AF%B4%E6%98%8E:~:text=%23-,3.%20%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B,-%E6%B3%A8%3A%20demo%E5%8F%AA%E6%98%AF">https://www.xfyun.cn/doc/spark/Web.html#_2-function-call%E8%AF%B4%E6%98%8E:~:text=%23-,3.%20%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B,-%E6%B3%A8%3A%20demo%E5%8F%AA%E6%98%AF</a></p><p>我建议引入其他大佬写好的 sdk ，GitHub 地址：<a href="https://github.com/briqt/xunfei-spark4j">https://github.com/briqt/xunfei-spark4j</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--修改version为最新稳定版--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.github.briqt<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xunfei-spark4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>调用的话，不使用硬编码，而是把相关信息写在配置文件里面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">SparkClient sparkClient=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SparkClient</span>();<br><br><span class="hljs-comment">// 设置认证信息</span><br>sparkClient.appid=<span class="hljs-string">&quot;&quot;</span>;<br>sparkClient.apiKey=<span class="hljs-string">&quot;&quot;</span>;<br>sparkClient.apiSecret=<span class="hljs-string">&quot;&quot;</span>;<br></code></pre></td></tr></table></figure><p>config 文件，读取我们配置的信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;xunfei.client&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XingHuoConfig</span> &#123;<br>    <span class="hljs-keyword">private</span> String appid;<br>    <span class="hljs-keyword">private</span> String apiSecret;<br>    <span class="hljs-keyword">private</span> String apiKey;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> SparkClient <span class="hljs-title function_">sparkClient</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">SparkClient</span> <span class="hljs-variable">sparkClient</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparkClient</span>();<br>        sparkClient.setApiKey(apiKey);<br>        sparkClient.setApiSecret(apiSecret);<br>        sparkClient.setAppid(appid);<br>        <span class="hljs-keyword">return</span> sparkClient;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>如果生成的内容不符合自己的预期，解决方法：给他一个符合标准的例子, 虽然有耗费 token 但是暂时没想到更好的方式</p><p>这个 PRECONDITION 是我在 service 调用之前手动拼接到 content 前面，没太深入了解是不是能提前指定预设😅</p><p>AI 服务类相关的代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Aiservice</span> &#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> SparkClient sparkClient;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ClientV4 clientV4;<br><br>    <span class="hljs-comment">// 稳定的随机数</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">STABLE_TEMPERATURE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.05f</span>;<br><br>    <span class="hljs-comment">//预设角色</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PRECONDITION</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;你是一个$&#123;角色定义&#125;，接下来我会按照以下固定格式给你提供内容：\n&quot;</span> +。。。。 + <span class="hljs-string">&quot;下面是一个具体的例子的模板：&quot;</span>+;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 星火AI 对话</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span></span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">sendMesToAIUseXingHuo</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String content)</span> &#123;<br>        List&lt;SparkMessage&gt; messages = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        messages.add(SparkMessage.userContent(content));<br>        <span class="hljs-comment">// 构造请求</span><br>        <span class="hljs-type">SparkRequest</span> <span class="hljs-variable">sparkRequest</span> <span class="hljs-operator">=</span> SparkRequest.builder()<br>                <span class="hljs-comment">// 消息列表</span><br>                .messages(messages)<br>                <span class="hljs-comment">// 模型回答的tokens的最大长度,非必传,取值为[1,4096],默认为2048</span><br>                .maxTokens(<span class="hljs-number">2048</span>)<br>                <span class="hljs-comment">// 核采样阈值。用于决定结果随机性,取值越高随机性越强即相同的问题得到的不同答案的可能性越高 非必传,取值为[0,1],默认为0.5</span><br>                .temperature(<span class="hljs-number">0.2</span>)<br>                <span class="hljs-comment">// 指定请求版本，默认使用最新2.0版本</span><br>                .apiVersion(SparkApiVersion.V3_5)<br>                .build();<br>        <span class="hljs-comment">// 同步调用</span><br>        <span class="hljs-type">SparkSyncChatResponse</span> <span class="hljs-variable">chatResponse</span> <span class="hljs-operator">=</span> sparkClient.chatSync(sparkRequest);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">responseContent</span> <span class="hljs-operator">=</span> chatResponse.getContent();<br>        log.info(<span class="hljs-string">&quot;星火 AI 返回的结果 &#123;&#125;&quot;</span>, responseContent);<br>        <span class="hljs-keyword">return</span> responseContent;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>AI大模型接入</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>多环境概念理解</title>
    <link href="/2024/11/16/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-%E5%A4%9A%E7%8E%AF%E5%A2%83/"/>
    <url>/2024/11/16/%E7%BD%91%E7%AB%99%E9%83%A8%E7%BD%B2-%E5%A4%9A%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h3 id="一：多环境概念："><a href="#一：多环境概念：" class="headerlink" title="一：多环境概念："></a>一：多环境概念：</h3><p>是指根据项目的不同阶段和需求，将项目部署在不同的环境中，以确保各环境之间相互独立且互不影响。多环境设计的主要目的是为了在不同的开发、测试和部署阶段中，确保项目的稳定性和可靠性。</p><h4 id="省流：根据实际需要，对项目阶段进行部署，相互独立且互相不影响。"><a href="#省流：根据实际需要，对项目阶段进行部署，相互独立且互相不影响。" class="headerlink" title="省流：根据实际需要，对项目阶段进行部署，相互独立且互相不影响。"></a>省流：<strong>根据实际需要，对项目阶段进行部署，相互独立且互相不影响。</strong></h4><h5 id="多环境的分类："><a href="#多环境的分类：" class="headerlink" title="多环境的分类："></a>多环境的分类：</h5><ol><li>本地环境(自己的电脑）localhost（熟悉的localhost）</li><li>开发环境：公司连同一台机器，方便开发</li><li>测试环境：性能测试&#x2F;功能测试&#x2F;系统集成测试</li><li>预发布环境（体验服）：用正式服的数据再进行测试</li><li>正式环境（线上，公开访问的项目）</li><li>沙箱环境：目的就是为了做实验（做完就销毁）</li></ol><h3 id="二：前端配置多环境："><a href="#二：前端配置多环境：" class="headerlink" title="二：前端配置多环境："></a>二：前端配置多环境：</h3><h5 id="1：请求地址："><a href="#1：请求地址：" class="headerlink" title="1：请求地址："></a>1：请求地址：</h5><ul><li>开发环境：localhost:8000</li><li>线上环境：域名或者公网ip</li></ul><p><strong>2：启动方式：</strong>（本人习惯使用npm）<br>npm run start </p><p>通常用于启动开发服务器或者应用程序的开发模式。这个命令一般会启动一个开发服务器，监听文件变化并自动重新加载应用，以方便开发人员在开发过程中进行实时调试。这个命令通常用于开发阶段，不会对代码进行优化和压缩，以便开发人员能够方便地调试和查看代码变化。</p><p>npm run build </p><p>通常用于构建生产环境下的部署包。这个命令会对项目代码进行优化、压缩和打包，以减小文件大小并提高运行效率。通常会生成用于部署的静态文件，准备好被部署到生产服务器上。这个命令一般在项目准备发布时执行，以确保发布的代码是经过优化和压缩的<br><strong>3：项目的配置：</strong></p><p> 不同的项目（框架）都有不同的配置文件，可以在配置文件后添加对应的环境名称后缀来区分开发环境和生产环境。</p><p>以vue项目举例，<code>NODE_ENV</code>环境变量通常用于指示当前的环境，是否为开发环境或生产环境。在开发环境中，通常会设置<code>NODE_ENV</code>为<code>development</code>，而在生产环境中设置为<code>production</code>。</p><p>build 时会自动传入 NODE_ENV &#x3D;&#x3D; production 参数</p><p>所以我们的思路是什么呢</p><p>我们可以在前端的拦截器上加一个判断条件，如果NODE_ENV是等于这个production的，我们就转到我们想要转的地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">const isDev = process.env.NODE_ENV === &#x27;development&#x27;;<br>const Service = axios.create(&#123;<br>    baseURL: isDev ? &#x27;http://localhost:8089/&#x27; : &#x27;http://公网ip或者域名&#x27;,<br>    withCredentials: true,<br>&#125;);<br>Service.defaults.withCredentials = true;<br></code></pre></td></tr></table></figure><p>一般上线的话，需要运行<strong>build 进行打包构建，然后生成一个dist文件</strong></p><p>随后，可以在项目终端使用 serve 工具启动（npm i -g serve，先安装），浏览打包好了的文件 </p><h3 id="三：后端配置多环境："><a href="#三：后端配置多环境：" class="headerlink" title="三：后端配置多环境："></a>三：后端配置多环境：</h3><h5 id="后端和前端一样都需要配置文件："><a href="#后端和前端一样都需要配置文件：" class="headerlink" title="后端和前端一样都需要配置文件："></a>后端和前端一样都需要配置文件：</h5><p>SpringBoot 项目，通过 application.yml 添加不同的后缀来区分配置文件(如application-prod.yml作为线上配置 )</p><h5 id="然后我们运行maven中的package，对项目进行打包"><a href="#然后我们运行maven中的package，对项目进行打包" class="headerlink" title="然后我们运行maven中的package，对项目进行打包"></a>然后我们运行maven中的package，对项目进行打包</h5><p>另外，如果单元测试不重要，我们就可以点击跳过测试模式这个按钮。</p><p> 打包完之后，我们在这个打包出来的文件夹（target）的终端中输入</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java -jar .\backend-<span class="hljs-number">0.0</span><span class="hljs-number">.1</span>-SNAPSHOT.jar --spring.profiles.active=prod<br></code></pre></td></tr></table></figure><p>那一行代码的意思就是往里传了一个环境参数，运行后就会切换到线上配置</p>]]></content>
    
    
    <categories>
      
      <category>网站部署</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>关于IDEA的mysql驱动文件下载失败的解决办法（来自以前的csdn）</title>
    <link href="/2024/11/12/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%981/"/>
    <url>/2024/11/12/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%981/</url>
    
    <content type="html"><![CDATA[<p>第一步，在官网上找到如图</p><p> <img src="/img/articles/1.png"> </p><p> 第二步 </p><p><img src="/img/articles/2.png"></p><p> 第三步</p><p>将下载好的驱动文件先解压然后再复制到安装IDEA的文件目录下面</p><p><img src="/img/articles/3.png"></p><p>最后，再回去IDEA点击驱动的下载</p><p>成功如图</p><p><img src="/img/articles/4.png"></p>]]></content>
    
    
    <categories>
      
      <category>配置各类环境所遇问题</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
